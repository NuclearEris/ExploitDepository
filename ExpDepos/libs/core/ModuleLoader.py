#!/usr/bin/env python

"""
@Author: Castiel
@Email:  ca3tie1@gmail.com
@Blog:   https://ca3tie1.github.io
@Git:    https://github.com/ca3tie1
@Wechat: Ca5tie1
@Date:   2021/3/14 10:50
"""

import importlib
from importlib import util
from ExpDepos.libs.core.common.Common import *


class ModuleLoader(object):
    """
    动态加载模块
    """
    @staticmethod
    def load_module_from_file(FilePath):
        """
        @function   根据模块文件名加载模块
        :param FilePath: 文件名路径，用于确定模块包路径及模块名
        :return: 模块实例
        """
        if not FilePath.endswith('.py'):
            print("模块文件必须是以'.py'结尾")
        spec = get_spec(FilePath)
        module_name = get_filename(FilePath, with_ext=False)
        if util.find_spec(spec) is None:
            print("无法加载模块 {0} 请确认模块文件路径是否正确.".format(spec))
        module = importlib.import_module(spec)
        module_class = getattr(module, module_name)
        module_exp = module_class()
        return module_exp
