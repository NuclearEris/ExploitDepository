#!/usr/bin/env python

"""
@Author: Castiel
@Email:  ca3tie1@gmail.com
@Blog:   https://ca3tie1.github.io
@Git:    https://github.com/ca3tie1
@Wechat: Ca5tie1
@Date:   2021/11/18 19:56
"""

from ExpDepos.libs.core.base.ModuleBase import *


class EncodeBase(ModuleBase):
    def __init__(self):
        super(EncodeBase, self).__init__()
        self.maxTime = 10
        self.OPTIONS.update({'time': OptInteger(1, description="编码器迭代次数", require=False)})

    def _options(self):
        return super()._options()

    def _encode(self, payload: any([str, bytes])) -> any([str, bytes]):
        raise NotImplementedError("encode")

    def encode(self, payload: any([str, bytes])) -> any([str, bytes]):
        i = 0
        while i < self.get_option("time") and i < self.maxTime:
            payload = self._encode(payload)
            i += 1
        return payload
