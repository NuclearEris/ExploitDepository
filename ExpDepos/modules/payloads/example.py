#!/usr/bin/env python

"""
@Author: Castiel
@Email:  ca3tie1@gmail.com
@Blog:   https://ca3tie1.github.io
@Git:    https://github.com/ca3tie1
@Wechat: Ca5tie1
@Date:   2021/11/30 21:52
"""

from ExpDepos.libs.core.base.PayloadBase import *


class example(PayloadBase):
    Name = 'payload example'  # payload名称
    Alias = 'payload_example'  # 漏洞别名
    Author = 'Castiel'  # 编写作者
    Category = EXP_CATEGORY.EXPLOITS.WEBAPP
    Create_Date = '2021-12-01'  # payload编写日期
    Update_Date = '2021-12-01'  # payload更新日期
    Desc = """payload 演示模块"""
    Description = """
- 在一个payload模块中可以使用OptPayload类型参数让用户指定一个其他的payload来构建当前payload
- 当使用OptPayload类型让用户提供其他payload的时候系统会为当前payload创建PAYLOAD_OPTS、PAYLOAD_ENC、PAYLOAD_ENC_OPTS参数
    - PAYLOAD_OPTS 参数用于设置其他payload参数
    - PAYLOAD_ENC  参数用于设置其他payload编码器
    - PAYLOAD_ENC_OPTS  用于设置其他payload编码器参数
    使用这些参数可以像在命令行中为payload设置参数用法一样，比如选择使用NormalEval来构建当前payload，NormalEval需要用户提供 lang 和 pass
    参数使用以下设置。
        - set PAYLOAD_OPTS --lang php --pass 123456
    """

    def _options(self):
        options = dict()
        options["payload"] = OptPayload("", description="选择要生成的payload", require=True)
        options["filename"] = OptString("cmd", description="连接密码", require=True)
        return options

    def _generate(self) -> any([str, builtins.bytes]):
        return f"filename: {self.get_option('filename')}, payload: {self.get_option('payload')}"
