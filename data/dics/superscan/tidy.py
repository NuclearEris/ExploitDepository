#!/usr/bin/env python

"""
@Author: Castiel
@Email:  ca3tie1@gmail.com
@Blog:   https://ca3tie1.github.io
@Git:    https://github.com/ca3tie1
@Wechat: Ca5tie1
@Date:   2021/12/16 16:02
"""

if __name__ == "__main__":
    dirs = []
    files = []

    for line in open("./tmp_dirs.txt"):
        if "../" in line or "..\\" in line or "%00" in line or ".exe" in line or line.startswith("/?")\
                or line.startswith("?"):
            continue
        line = line.strip()
        if not line.startswith("/"):
            line = "/" + line
        if "." in line or '$VAR$' in line or '%EXT%' in line or '{ext}' in line:
            files.append(line)
        else:
            dirs.append(line)
    for line in open("./tmp_files.txt"):
        if "../" in line:
            continue
        line = line.strip()
        if not line.startswith("/"):
            line = "/" + line
        if "." not in line and '$' not in line:
            dirs.append(line)
            continue
        files.append(line)

    print(f"获取dirs: {len(dirs)}, files: {len(files)}")

    dirs = list(set(dirs))
    files = list(set(files))

    print(f"去重后dirs: {len(dirs)}, files: {len(files)}")

    with open("./dirs.dic", "a") as dir:
        for line in dirs:
            if len(line) > 0:
                if not line.endswith("\n"):
                    line += "\n"
                dir.write(line)

    with open("./files.dic", "a") as file:
        for line in files:
            if len(line) > 0:
                if not line.endswith("\n"):
                    line += "\n"
                file.write(line)
