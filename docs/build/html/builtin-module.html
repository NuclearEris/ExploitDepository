<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>内置模块 &mdash; ExpDepos latest 文档</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script src="_static/translations.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜索" href="search.html" />
    <link rel="next" title="参考" href="reference.html" />
    <link rel="prev" title="指纹编写" href="fingerprint.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> ExpDepos
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="在文档中搜索" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">高级用法</a></li>
<li class="toctree-l1"><a class="reference internal" href="usescf.html">使用云函数</a></li>
<li class="toctree-l1"><a class="reference internal" href="moduledev.html">模块开发</a></li>
<li class="toctree-l1"><a class="reference internal" href="payload.html">Payload编写</a></li>
<li class="toctree-l1"><a class="reference internal" href="encoder.html">Encoder编写</a></li>
<li class="toctree-l1"><a class="reference internal" href="fingerprint.html">指纹编写</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">内置模块</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#superscan">SuperScan</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#portscan">端口扫描(PortScan)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">端口扫描</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">服务探测</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fp">指纹识别</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dirscan">目录扫描(DirScan)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id5">目录扫描</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">添加字典</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fpsscan">指纹识别(FpsScan)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#addfps">AddFps</a></li>
<li class="toctree-l2"><a class="reference internal" href="#register">register</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id7">指纹过滤</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">参考</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ExpDepos</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>内置模块</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/builtin-module.rst.txt" rel="nofollow"> 查看页面源码</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="id1">
<h1>内置模块<a class="headerlink" href="#id1" title="永久链接至标题"></a></h1>
<section id="superscan">
<h2>SuperScan<a class="headerlink" href="#superscan" title="永久链接至标题"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">SuperScan</span></code> (别名: <code class="docutils literal notranslate"><span class="pre">superscan</span></code> ) 模块为 <code class="docutils literal notranslate"><span class="pre">ExpDepos</span></code> 内置的一款多功能扫描器，支持目录扫描(<code class="docutils literal notranslate"><span class="pre">dirscan</span></code>)、端口扫描(<code class="docutils literal notranslate"><span class="pre">portscan</span></code>)、指纹探测(<code class="docutils literal notranslate"><span class="pre">fingerprint</span> <span class="pre">scan</span></code>)等功能。
<code class="docutils literal notranslate"><span class="pre">SuperScan</span></code> 作为  <code class="docutils literal notranslate"><span class="pre">ExpDepos</span></code> 框架标志性模块在于其多功能扫描均可采用云函数代理请求的方式进行，该功能在红蓝实战对抗的情报搜集阶段可与防火墙等安全设备进行有效对抗。
使用以下命令格式查看 <code class="docutils literal notranslate"><span class="pre">SuperScan</span></code> 模块命令帮助或者运行该模块:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">python3</span> <span class="n">cli</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">M</span> <span class="n">superscan</span> <span class="o">-</span><span class="n">h</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p><code class="docutils literal notranslate"><span class="pre">SuperScan</span></code> 端口扫描模块的存活主机探测功能需要管理员权限运行，进行端口扫描时候请确认当前用户权限或者使用 <code class="docutils literal notranslate"><span class="pre">--noping</span></code> 参数跳过存活主机探测。</p>
</div>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>为达到最佳性能和效果，建议在 <code class="docutils literal notranslate"><span class="pre">Mac</span> <span class="pre">OS</span></code> 或者 <code class="docutils literal notranslate"><span class="pre">Kali</span> <span class="pre">Linux</span></code> 等非 <code class="docutils literal notranslate"><span class="pre">Windows</span></code> 系统上运行本模块。全局的 <code class="docutils literal notranslate"><span class="pre">--scf</span></code> 选项为开启云函数扫描的开关。</p>
</div>
<section id="portscan">
<h3>端口扫描(PortScan)<a class="headerlink" href="#portscan" title="永久链接至标题"></a></h3>
<p>使用 <code class="docutils literal notranslate"><span class="pre">SuperScan</span></code> 进行端口扫描请使用如下命令:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">python3</span> <span class="n">cli</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">M</span> <span class="n">superscan</span> <span class="o">-</span><span class="n">P</span> <span class="s2">&quot;--action port&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="mf">192.168.1.10</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">--action</span></code> 选项值指示使用端口扫描模块，扫描目标则像运行其他模块一样使用全局的 <code class="docutils literal notranslate"><span class="pre">-H</span></code> 或者 <code class="docutils literal notranslate"><span class="pre">--host</span></code> 传入。传入的主机地址支持 <code class="docutils literal notranslate"><span class="pre">CIDR</span></code> 格式或者使用 <code class="docutils literal notranslate"><span class="pre">-</span></code> 连接的IP地址范围，亦或是使用 <code class="docutils literal notranslate"><span class="pre">','</span></code> 分隔的多个IP地址，以上三种亦可组合使用。</p>
<section id="id2">
<h4>端口扫描<a class="headerlink" href="#id2" title="永久链接至标题"></a></h4>
<p>在未指定需要扫描的端口情况下，<code class="docutils literal notranslate"><span class="pre">SuperScan</span></code> 将使用常用WEB应用端口列表(<code class="docutils literal notranslate"><span class="pre">default_ports</span></code>)及额外补充端口列表(<code class="docutils literal notranslate"><span class="pre">extend_ports</span></code>)作为默认列表进行扫描。若需要自定义端口扫描请使用模块选项 <code class="docutils literal notranslate"><span class="pre">--ports</span></code> 指定需要扫描的端口列表或者范围，如下命令所示:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">python3</span> <span class="n">cli</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">M</span> <span class="n">superscan</span> <span class="o">-</span><span class="n">P</span> <span class="s2">&quot;--action port --ports 8000-9000,22,3389&quot;</span> <span class="o">-</span><span class="n">H</span> <span class="mf">192.168.1.10</span>
</pre></div>
</div>
<p>模块选项 <code class="docutils literal notranslate"><span class="pre">--ports</span></code> 除了提供常规端口列表之外，还可以传入 <code class="docutils literal notranslate"><span class="pre">web</span></code> 或者 <code class="docutils literal notranslate"><span class="pre">top</span></code> 值用于指定扫描 <code class="docutils literal notranslate"><span class="pre">default_ports</span></code> 或是 <code class="docutils literal notranslate"><span class="pre">nmap_top_10000</span></code> 中定义的端口。</p>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p><code class="docutils literal notranslate"><span class="pre">default_ports</span></code>、<code class="docutils literal notranslate"><span class="pre">nmap_top_10000</span></code> 及 <code class="docutils literal notranslate"><span class="pre">extend_ports</span></code> 定义位于 <code class="docutils literal notranslate"><span class="pre">ExpDepos/modules/auxiliary/scanner/superscan/PortLists.py</span></code> 模块中，可以自定义修改该模块中的定义来修改默认扫描值。</p>
</div>
</section>
<section id="id3">
<h4>服务探测<a class="headerlink" href="#id3" title="永久链接至标题"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">SuperScan</span></code> 的端口扫描功能不仅可进行简单的端口扫描，同时还支持 <code class="docutils literal notranslate"><span class="pre">Nmap</span></code> 开源的服务探针(<code class="docutils literal notranslate"><span class="pre">nmap-service-probes</span></code>)对已开放的端口进行服务识别。若已开放端口识别到 <code class="docutils literal notranslate"><span class="pre">HTTP</span></code> 服务则进一步对该端口进行WEB指纹探测及WEB标题和状态识别。</p>
<p>若无需端口服务探测或者WEB指纹识别可以使用 <code class="docutils literal notranslate"><span class="pre">--nosrv</span></code> 和 <code class="docutils literal notranslate"><span class="pre">--nofp</span></code> 进行关闭。若两者均不需要则可以使用 <code class="docutils literal notranslate"><span class="pre">--noprobe</span></code> 参数关闭服务和WEB指纹识别，更多选项请查看命令帮助。</p>
</section>
<section id="fp">
<span id="id4"></span><h4>指纹识别<a class="headerlink" href="#fp" title="永久链接至标题"></a></h4>
<p>在WEB指纹识别上亦有多个选项可供使用，例如 <code class="docutils literal notranslate"><span class="pre">--fpmode</span></code> 参数可设置指纹识别模式，有 <code class="docutils literal notranslate"><span class="pre">ALL</span></code>、 <code class="docutils literal notranslate"><span class="pre">PASS</span></code>、 <code class="docutils literal notranslate"><span class="pre">AGGR</span></code>、 <code class="docutils literal notranslate"><span class="pre">EXP</span></code> 可选(区分大小写，默认为 <code class="docutils literal notranslate"><span class="pre">ALL</span></code>)。有关指纹识别模式详情，请参阅 <a class="reference internal" href="moduledev.html#fp-detect"><span class="std std-ref">指纹识别</span></a> 章节。</p>
<p>同时在进行WEB指纹识别时候亦可以提供相关过滤参数，让扫描器只选择过滤器中指定的指纹进行识别，<code class="docutils literal notranslate"><span class="pre">--fptype</span></code>、<code class="docutils literal notranslate"><span class="pre">--fpplat</span></code>、 <code class="docutils literal notranslate"><span class="pre">--fpmidd</span></code>、<code class="docutils literal notranslate"><span class="pre">--fplang</span></code> 选项可为指纹过滤器提供过滤选项，有关过滤器详情请参阅 <a class="reference internal" href="moduledev.html#fp-detect"><span class="std std-ref">指纹识别</span></a> 及 <a class="reference internal" href="fingerprint.html#fp-attr"><span class="std std-ref">指纹属性</span></a> 章节。</p>
</section>
</section>
<section id="dirscan">
<h3>目录扫描(DirScan)<a class="headerlink" href="#dirscan" title="永久链接至标题"></a></h3>
<p>要使用 <code class="docutils literal notranslate"><span class="pre">SuperScan</span></code> 进行目录扫描请使用如下命令:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">cli</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">M</span> <span class="n">superscan</span> <span class="o">-</span><span class="n">H</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">SuperScan</span></code> 在未设置 <code class="docutils literal notranslate"><span class="pre">--action</span></code> 选项的情况下默认调用目录扫描模块，其目录扫描字典调用内置的 <code class="docutils literal notranslate"><span class="pre">dirs.dic</span></code> 和 <code class="docutils literal notranslate"><span class="pre">files.dic</span></code> 中的条目进行扫描。</p>
<section id="id5">
<h4>目录扫描<a class="headerlink" href="#id5" title="永久链接至标题"></a></h4>
<p>若要进行单独的目录扫描或者文件扫描请使用 <code class="docutils literal notranslate"><span class="pre">--dic</span></code> 选项提供相应值，可选 <code class="docutils literal notranslate"><span class="pre">dir</span></code> (仅目录)、<code class="docutils literal notranslate"><span class="pre">file</span></code> (仅文件)、<code class="docutils literal notranslate"><span class="pre">all</span></code> (目录和文件) 默认 <code class="docutils literal notranslate"><span class="pre">all</span></code> 。在进行文件扫描时候可以使用 <code class="docutils literal notranslate"><span class="pre">--ext</span></code> 选项指定扩展名，多个扩展名请用 <code class="docutils literal notranslate"><span class="pre">','</span></code> 分隔。</p>
<p>除了内置字典选项外，目录扫描模块同时支持使用 <code class="docutils literal notranslate"><span class="pre">--wordlist</span></code> 自定义位于 <code class="docutils literal notranslate"><span class="pre">/data/dics/superscan/</span></code> 下的字典文件, 多个使用 <code class="docutils literal notranslate"><span class="pre">','</span></code> 分隔。</p>
</section>
<section id="id6">
<h4>添加字典<a class="headerlink" href="#id6" title="永久链接至标题"></a></h4>
<p>在日常渗透积累中，可以在 <code class="docutils literal notranslate"><span class="pre">console</span></code> 模式下使用 <code class="docutils literal notranslate"><span class="pre">add</span> <span class="pre">dir</span></code> 或者 <code class="docutils literal notranslate"><span class="pre">add</span> <span class="pre">file</span></code> 命令将目录字典添加到现有字典中去。</p>
</section>
</section>
<section id="fpsscan">
<h3>指纹识别(FpsScan)<a class="headerlink" href="#fpsscan" title="永久链接至标题"></a></h3>
<p>在 <code class="docutils literal notranslate"><span class="pre">SuperScan</span></code> 中设置选项 <code class="docutils literal notranslate"><span class="pre">--action</span></code> 值为 <code class="docutils literal notranslate"><span class="pre">fps</span></code> 将调用单独的指纹识别模块，其指纹识别相关选项与端口扫描中的 <a class="reference internal" href="#fp"><span class="std std-ref">指纹识别</span></a> 参数共享。</p>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>开启全局 <code class="docutils literal notranslate"><span class="pre">Debug</span></code> 消息模式可以详细查看到指纹识别匹配详情。</p>
</div>
</section>
</section>
<section id="addfps">
<h2>AddFps<a class="headerlink" href="#addfps" title="永久链接至标题"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">AddFps</span></code> (别名: <code class="docutils literal notranslate"><span class="pre">addfps</span></code> ) 模块可以以向导的方式添加指纹到指纹库中，具体使用帮助请参阅 <a class="reference internal" href="fingerprint.html#add-fps"><span class="std std-ref">使用向导编写指纹</span></a></p>
</section>
<section id="register">
<h2>register<a class="headerlink" href="#register" title="永久链接至标题"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">register</span></code> (别名: <code class="docutils literal notranslate"><span class="pre">wwfpr</span></code>) 为一个专门将 <a class="reference external" href="https://github.com/winezer0/whatweb-plus">whatweb-plus</a> 指纹转换为 <code class="docutils literal notranslate"><span class="pre">ExpDepos</span></code> 可用格式( <code class="docutils literal notranslate"><span class="pre">yaml</span></code> )指纹的模块。运行该模块值需要指定 <code class="docutils literal notranslate"><span class="pre">--path</span></code> 参数为 <code class="docutils literal notranslate"><span class="pre">whatweb-plus</span></code> 指纹路径(my-plugins目录路径)即可。</p>
<section id="id7">
<h3>指纹过滤<a class="headerlink" href="#id7" title="永久链接至标题"></a></h3>
<p>在运行模块执行转换之前可以使用过滤定义排除一些无用或者分类不正确的指纹，这些定义位于 <code class="docutils literal notranslate"><span class="pre">ExpDepos/modules/auxiliary/tools/register_filters.py</span></code> 文件中，其中指纹排除定义如下:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">FILE_BLACK_LIST</span></code>         定义的列表为 <code class="docutils literal notranslate"><span class="pre">whatweb-plus</span></code> 完全可以舍弃的无用指纹。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NEED_ADN_LOGIC_LIST</span></code>     定义的列表为 <code class="docutils literal notranslate"><span class="pre">whatweb-plus</span></code> 中匹配项应该使用逻辑and运算进行匹配的指纹。例如 <code class="docutils literal notranslate"><span class="pre">蓝凌oa-ekp.rb</span></code> 中的匹配项 <code class="docutils literal notranslate"><span class="pre">{:search=&gt;&quot;all&quot;,</span> <span class="pre">:text=&gt;'EKP'}</span></code> 和 <code class="docutils literal notranslate"><span class="pre">{:search=&gt;&quot;all&quot;,</span> <span class="pre">:text=&gt;'蓝凌OA'}</span></code>， 前者匹配范围太广，应该与后者同时满足才算匹配成功。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MATCHES_BLACK_VALUES</span></code>    定义的列表为一些可以舍弃的匹配项的列表 例如 <code class="docutils literal notranslate"><span class="pre">prototype.rb</span></code> 中已有两个较高精度的匹配项，然后另外匹配项 <code class="docutils literal notranslate"><span class="pre">{:search=&gt;&quot;all&quot;,</span> <span class="pre">:text=&gt;'Prototype'}</span></code> 范围过于广泛，则需要单独屏蔽掉该匹配项。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FINGERPRINT_TYPES</span></code>       分类修正字典用于修正 <code class="docutils literal notranslate"><span class="pre">whatweb-plus</span></code> 中一些分类不准确的指纹，且分类值可以使用列表类型设置指纹归属多个分类。例如一些安全设备的后台管理系统也可以分类到WEB应用类中，以便在只扫描WEB应用的时候也能发现安全设备的后台系统。</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>针对所有使用了文件名的过滤均可以使用通配符 <code class="docutils literal notranslate"><span class="pre">'*'</span></code> 和 <code class="docutils literal notranslate"><span class="pre">'?'</span></code></p>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="fingerprint.html" class="btn btn-neutral float-left" title="指纹编写" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="reference.html" class="btn btn-neutral float-right" title="参考" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2021, Ca5tie1.</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用了 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a>开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>